# 新功能测试指南

## 测试环境准备

### Android测试
1. 确保设备运行Android 5.0+
2. 授予应用存储权限
3. 准备测试用的M3U文件

### Desktop测试
1. 确保安装了VLC Media Player
2. 准备测试用的M3U文件
3. 确保有网络连接

## 功能测试清单

### 1. 全屏播放优化测试（Android）

#### 测试步骤
1. 打开应用并选择任意频道播放
2. 点击"全屏"按钮
3. 观察以下行为：
   - [ ] 屏幕自动切换到横屏
   - [ ] 系统状态栏和导航栏隐藏
   - [ ] 播放器控制按钮显示
4. 等待3秒
   - [ ] 控制按钮自动隐藏
5. 点击屏幕任意位置
   - [ ] 控制按钮重新显示
6. 再次等待3秒
   - [ ] 控制按钮再次自动隐藏
7. 点击"退出全屏"按钮
   - [ ] 屏幕恢复竖屏
   - [ ] 系统UI恢复显示

#### 预期结果
- 全屏模式下自动横屏
- 控制按钮3秒后自动隐藏
- 点击屏幕可重新显示控制按钮
- 退出全屏恢复正常

### 2. 手动刷新Xtream配置测试

#### 前置条件
- 已添加至少一个Xtream播放列表

#### 测试步骤
1. 在播放列表界面找到Xtream播放列表
2. 点击播放列表右侧的齿轮图标
3. 在菜单中选择"刷新"
4. 观察以下行为：
   - [ ] 显示"正在刷新播放列表..."加载提示
   - [ ] 刷新完成后提示消失
   - [ ] 播放列表更新时间改变
5. 进入播放列表查看频道
   - [ ] 频道列表已更新
   - [ ] 分类信息已更新

#### 错误场景测试
1. 断开网络连接
2. 尝试刷新Xtream播放列表
   - [ ] 显示网络错误提示
3. 尝试刷新M3U URL播放列表
   - [ ] 成功刷新或显示相应错误
4. 尝试刷新本地M3U文件播放列表
   - [ ] 显示"本地M3U文件无法刷新"错误

#### 预期结果
- Xtream播放列表可以成功刷新
- 刷新后数据更新
- 网络错误时显示友好提示
- 本地文件无法刷新并提示

### 3. 导出Xtream为M3U文件测试

#### 测试步骤
1. 在播放列表界面选择任意播放列表
2. 点击齿轮图标，选择"导出为M3U"
3. 在文件保存对话框中：
   - [ ] 默认文件名为"播放列表名称.m3u"
   - [ ] 可以修改文件名
   - [ ] 可以选择保存位置
4. 点击保存
   - [ ] 显示"正在导出M3U文件..."加载提示
   - [ ] 导出完成后提示消失
5. 检查导出的文件：
   - [ ] 文件存在于指定位置
   - [ ] 文件大小合理（不为0）
   - [ ] 使用文本编辑器打开，格式正确

#### M3U文件格式验证
打开导出的M3U文件，检查：
```
#EXTM3U
#EXTINF:-1 tvg-id="xxx" tvg-logo="http://..." group-title="分组名",频道名称
http://频道URL
```
- [ ] 包含#EXTM3U头
- [ ] 每个频道有#EXTINF行
- [ ] 包含tvg-id、tvg-logo、group-title等属性
- [ ] 频道URL正确

#### 不同类型播放列表测试
1. 导出Xtream播放列表
   - [ ] 成功导出
2. 导出M3U URL播放列表
   - [ ] 成功导出
3. 导出本地M3U文件播放列表
   - [ ] 成功导出

#### 预期结果
- 所有类型播放列表都可以导出
- 导出的M3U文件格式正确
- 包含所有频道信息

### 4. 从本地读取M3U源文件测试

#### 准备测试文件
创建一个测试M3U文件（test.m3u）：
```
#EXTM3U
#EXTINF:-1 tvg-id="test1" tvg-logo="http://example.com/logo1.png" group-title="测试",测试频道1
http://example.com/stream1.m3u8
#EXTINF:-1 tvg-id="test2" tvg-logo="http://example.com/logo2.png" group-title="测试",测试频道2
http://example.com/stream2.m3u8
```

#### 测试步骤
1. 点击播放列表界面的"+"按钮
2. 在对话框中选择"本地文件"标签
   - [ ] 标签显示正确
3. 输入播放列表名称"我的测试播放列表"
4. 点击"选择M3U文件"按钮
   - [ ] 打开文件选择器
5. 选择准备好的test.m3u文件
   - [ ] 显示"正在读取M3U文件..."加载提示
6. 等待导入完成
   - [ ] 加载提示消失
   - [ ] 返回播放列表界面
7. 检查新添加的播放列表：
   - [ ] 名称为"我的测试播放列表"
   - [ ] 类型显示为"M3U (文件)"
   - [ ] 频道数量正确（2个）
8. 进入播放列表查看频道：
   - [ ] 显示2个频道
   - [ ] 频道名称正确
   - [ ] 分组信息正确

#### 错误场景测试
1. 选择非M3U文件（如.txt）
   - [ ] 显示格式错误或解析失败提示
2. 选择空文件
   - [ ] 显示"未找到频道"或类似提示
3. 取消文件选择
   - [ ] 返回对话框，不添加播放列表
4. 不输入名称直接选择文件
   - [ ] 使用默认名称"本地M3U播放列表"

#### 大文件测试
1. 准备一个包含100+频道的M3U文件
2. 导入该文件
   - [ ] 显示加载提示
   - [ ] 成功导入所有频道
   - [ ] 导入时间合理（不超过10秒）

#### 预期结果
- 可以成功选择和导入M3U文件
- 频道信息正确解析
- 错误情况有友好提示
- 大文件也能正常处理

## 集成测试

### 完整工作流测试

#### 场景1：Xtream → 导出 → 导入
1. 添加Xtream播放列表
2. 导出为M3U文件
3. 将导出的M3U文件作为本地文件导入
4. 验证：
   - [ ] 两个播放列表频道数量相同
   - [ ] 频道信息一致

#### 场景2：刷新 → 导出
1. 添加Xtream播放列表
2. 刷新播放列表
3. 导出为M3U文件
4. 验证：
   - [ ] 导出的文件包含最新数据

#### 场景3：全屏播放 + 切换频道
1. 播放频道并进入全屏
2. 在全屏模式下返回
3. 选择另一个频道播放
4. 再次进入全屏
5. 验证：
   - [ ] 全屏功能正常
   - [ ] 频道切换正常
   - [ ] 没有崩溃或卡顿

## 性能测试

### 导入性能
- [ ] 100个频道的M3U文件导入时间 < 5秒
- [ ] 500个频道的M3U文件导入时间 < 15秒
- [ ] 1000个频道的M3U文件导入时间 < 30秒

### 导出性能
- [ ] 100个频道导出时间 < 3秒
- [ ] 500个频道导出时间 < 10秒
- [ ] 1000个频道导出时间 < 20秒

### 刷新性能
- [ ] Xtream刷新时间 < 30秒（取决于网络）
- [ ] M3U URL刷新时间 < 15秒（取决于网络）

## 兼容性测试

### Android版本
- [ ] Android 5.0 (API 21)
- [ ] Android 8.0 (API 26)
- [ ] Android 10 (API 29)
- [ ] Android 11+ (API 30+)

### Desktop平台
- [ ] Windows 10/11
- [ ] macOS 10.15+
- [ ] Linux (Ubuntu 20.04+)

## 回归测试

确保新功能不影响现有功能：
- [ ] 添加M3U URL播放列表
- [ ] 添加Xtream账户
- [ ] 播放频道
- [ ] 收藏频道
- [ ] 浏览分类
- [ ] 搜索频道

## 测试报告模板

### 测试信息
- 测试日期：
- 测试人员：
- 测试平台：Android / Desktop
- 设备型号：
- 系统版本：

### 测试结果
| 功能 | 测试项 | 结果 | 备注 |
|------|--------|------|------|
| 全屏播放优化 | 自动横屏 | ✓/✗ | |
| 全屏播放优化 | 自动隐藏控制 | ✓/✗ | |
| 刷新Xtream | 基本功能 | ✓/✗ | |
| 导出M3U | 基本功能 | ✓/✗ | |
| 导入本地M3U | 基本功能 | ✓/✗ | |

### 发现的问题
1. 
2. 
3. 

### 建议
1. 
2. 
3. 
